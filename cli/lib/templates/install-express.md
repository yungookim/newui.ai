---
framework: express
widgetPackage: "@ncodes/widget"
capabilityMapPath: "{{capabilityMapPath}}"
generatedBy: "n.codes CLI v{{version}}"
generatedAt: "{{timestamp}}"
---

# n.codes Installation for Express

## Prerequisites
- `{{capabilityMapPath}}` exists in project root (generated by `n.codes sync`)
- Project uses Express with a template engine (EJS, Pug, Handlebars, or static HTML)

## Step 1: Install the widget package

**Action:** Install the n.codes widget SDK.

```bash
npm install @ncodes/widget
```

**Verify:** `node_modules/@ncodes/widget` directory exists.

## Step 2: Copy capability map and widget to public/

**Action:** Copy the JSON capability map and widget script to your static files directory.

```bash
cp {{capabilityMapPath}} public/n.codes.capabilities.json
cp node_modules/@ncodes/widget/dist/ncodes-widget.js public/ncodes-widget.js
```

**Verify:** Both files exist in `public/`.

## Step 3: Serve static files (if not already)

**File:** Your main Express entry file (e.g., `app.js`, `server.js`, `index.js`)
**Action:** Ensure Express serves static files from the public directory.

```js
app.use(express.static('public'));
```

**Verify:** Static file serving is configured.

## Step 4: Add widget script to your HTML layout

**File:** Your main layout template (e.g., `views/layout.ejs`, `views/layout.pug`, or HTML files)
**Action:** Add the widget script tag and initialization before the closing `</body>` tag.

For EJS:
```html
<script src="/ncodes-widget.js"></script>
<script>
  NCodes.init({
    user: <%-  JSON.stringify(user || null) %>,
    capabilityMapUrl: '/n.codes.capabilities.json',
    mode: 'simulation',
    theme: 'auto',
  });
</script>
```

For static HTML:
```html
<script src="/ncodes-widget.js"></script>
<script>
  // Replace with your actual auth state
  NCodes.init({
    user: { id: 'demo', name: 'Demo User' },
    capabilityMapUrl: '/n.codes.capabilities.json',
    mode: 'simulation',
    theme: 'auto',
  });
</script>
```

**Note:** Pass the logged-in user object from your auth middleware. Pass `null` when not logged in.

**Verify:** The layout template includes the script tags.

## Verification

1. Start the server: `npm start` or `node app.js`
2. Open the app in a browser
3. Confirm the "Build with AI" floating button appears
4. Click it and test the prompt panel
