---
framework: next-pages-router
widgetPackage: "@ncodes/widget"
capabilityMapPath: "{{capabilityMapPath}}"
generatedBy: "n.codes CLI v{{version}}"
generatedAt: "{{timestamp}}"
---

# n.codes Installation for Next.js (Pages Router)

## Prerequisites
- `{{capabilityMapPath}}` exists in project root (generated by `n.codes sync`)
- Project uses Next.js with Pages Router (`pages/` directory)

## Step 1: Install the widget package

**Action:** Install the n.codes widget SDK.

```bash
npm install @ncodes/widget
```

**Verify:** `node_modules/@ncodes/widget` directory exists.

## Step 2: Copy capability map to public/

**Action:** Copy the JSON capability map to the public directory.

```bash
cp {{capabilityMapPath}} public/n.codes.capabilities.json
```

**Verify:** `public/n.codes.capabilities.json` exists and is valid JSON.

## Step 3: Add widget initialization to _app

**File:** `pages/_app.tsx` (or `pages/_app.jsx`)
**Action:** Add a `useEffect` hook to initialize the n.codes widget with the current user.

```tsx
// Add these imports at the top:
import { useEffect } from 'react';

// Add this inside the App component, before the return statement:
useEffect(() => {
  // Replace with your actual auth logic
  const user = { id: 'demo', name: 'Demo User' };
  if (!user) return;

  let NCodes: any;
  import('@ncodes/widget').then((mod) => {
    NCodes = mod;
    NCodes.init({
      user,
      capabilityMapUrl: '/n.codes.capabilities.json',
      mode: 'simulation',
      theme: 'auto',
    });
  });

  return () => {
    if (NCodes) NCodes.destroy();
  };
}, []);
```

**Note:** Replace the hardcoded user with your auth state. Pass `null` when logged out â€” the widget will hide itself.

**Verify:** `pages/_app.tsx` contains the `NCodes.init()` call.

## Verification

1. Start the dev server: `npm run dev`
2. Open the app in a browser
3. Confirm the "Build with AI" floating button appears
4. Click it and enter a prompt
5. Confirm the prompt panel opens and simulation works
